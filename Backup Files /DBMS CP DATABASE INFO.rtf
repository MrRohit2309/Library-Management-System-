{\rtf1\ansi\ansicpg1252\cocoartf2867
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fnil\fcharset0 Menlo-Regular;\f1\fnil\fcharset0 AppleColorEmoji;}
{\colortbl;\red255\green255\blue255;\red0\green0\blue0;}
{\*\expandedcolortbl;;\csgray\c0;}
\paperw11900\paperh16840\margl1440\margr1440\vieww28600\viewh18000\viewkind0
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\fs30 \cf2 \CocoaLigature0 mysql> SHOW TABLES;\
+-----------------------------+\
| Tables_in_librarymanagement |\
+-----------------------------+\
| Books                       |\
| IssuedBooks                 |\
| ReturnRecords               |\
| Students                    |\
+-----------------------------+\
4 rows in set (0.00 sec)\
\
mysql> DESC Books;\
+------------------+--------------+------+-----+---------+----------------+\
| Field            | Type         | Null | Key | Default | Extra          |\
+------------------+--------------+------+-----+---------+----------------+\
| book_id          | int          | NO   | PRI | NULL    | auto_increment |\
| title            | varchar(150) | NO   |     | NULL    |                |\
| author_name      | varchar(100) | YES  |     | NULL    |                |\
| genre            | varchar(50)  | YES  |     | NULL    |                |\
| total_copies     | int          | YES  |     | 1       |                |\
| available_copies | int          | YES  |     | 1       |                |\
+------------------+--------------+------+-----+---------+----------------+\
6 rows in set (0.00 sec)\
\
mysql> DESC IssuedBooks\
    -> ;\
+-------------+-------------+------+-----+-----------+-------------------+\
| Field       | Type        | Null | Key | Default   | Extra             |\
+-------------+-------------+------+-----+-----------+-------------------+\
| issue_id    | int         | NO   | PRI | NULL      | auto_increment    |\
| student_id  | int         | YES  | MUL | NULL      |                   |\
| book_id     | int         | YES  | MUL | NULL      |                   |\
| issue_date  | date        | YES  |     | curdate() | DEFAULT_GENERATED |\
| due_date    | date        | YES  |     | NULL      |                   |\
| return_date | date        | YES  |     | NULL      |                   |\
| status      | varchar(20) | YES  |     | Issued    |                   |\
+-------------+-------------+------+-----+-----------+-------------------+\
7 rows in set (0.00 sec)\
\
mysql> DESC ReturnRecords;\
+-------------+---------------+------+-----+---------+----------------+\
| Field       | Type          | Null | Key | Default | Extra          |\
+-------------+---------------+------+-----+---------+----------------+\
| return_id   | int           | NO   | PRI | NULL    | auto_increment |\
| issue_id    | int           | YES  | MUL | NULL    |                |\
| return_date | date          | YES  |     | NULL    |                |\
| fine_amount | decimal(10,2) | YES  |     | NULL    |                |\
+-------------+---------------+------+-----+---------+----------------+\
4 rows in set (0.00 sec)\
\
mysql> DESC Students;\
+--------------+--------------+------+-----+---------+-------+\
| Field        | Type         | Null | Key | Default | Extra |\
+--------------+--------------+------+-----+---------+-------+\
| student_id   | int          | NO   | PRI | NULL    |       |\
| student_name | varchar(100) | NO   |     | NULL    |       |\
| department   | varchar(50)  | YES  |     | NULL    |       |\
| year         | int          | YES  |     | NULL    |       |\
| contact_no   | varchar(15)  | YES  |     | NULL    |       |\
| email        | varchar(100) | YES  | UNI | NULL    |       |\
+--------------+--------------+------+-----+---------+-------+\
6 rows in set (0.00 sec)\
\
mysql> SHOW PROCEDURE STATUS WHERE Db = 'LibraryManagement';\
+-------------------+------------+-----------+----------------+---------------------+---------------------+---------------+---------+----------------------+----------------------+--------------------+\
| Db                | Name       | Type      | Definer        | Modified            | Created             | Security_type | Comment | character_set_client | collation_connection | Database Collation |\
+-------------------+------------+-----------+----------------+---------------------+---------------------+---------------+---------+----------------------+----------------------+--------------------+\
| LibraryManagement | IssueBook  | PROCEDURE | root@localhost | 2025-11-03 14:04:53 | 2025-11-03 14:04:53 | DEFINER       |         | utf8mb4              | utf8mb4_0900_ai_ci   | utf8mb4_0900_ai_ci |\
| LibraryManagement | ReturnBook | PROCEDURE | root@localhost | 2025-11-03 14:17:05 | 2025-11-03 14:17:05 | DEFINER       |         | utf8mb4              | utf8mb4_0900_ai_ci   | utf8mb4_0900_ai_ci |\
+-------------------+------------+-----------+----------------+---------------------+---------------------+---------------+---------+----------------------+----------------------+--------------------+\
2 rows in set (0.01 sec)\
\
mysql> SHOW TRIGGERS;\
+-------------------------+--------+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+------------------------+-----------------------------------------------------------------------------------------------------------------------+----------------+----------------------+----------------------+--------------------+\
| Trigger                 | Event  | Table         | Statement                                                                                                                                                                                                                                                                         | Timing | Created                | sql_mode                                                                                                              | Definer        | character_set_client | collation_connection | Database Collation |\
+-------------------------+--------+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+------------------------+-----------------------------------------------------------------------------------------------------------------------+----------------+----------------------+----------------------+--------------------+\
| check_book_availability | INSERT | IssuedBooks   | BEGIN\
    DECLARE available INT;\
    SELECT available_copies INTO available FROM Books WHERE book_id = NEW.book_id;\
    IF available <= 0 THEN\
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Cannot issue: No copies available!';\
    END IF;\
END                           | BEFORE | 2025-11-03 14:05:11.01 | ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION | root@localhost | utf8mb4              | utf8mb4_0900_ai_ci   | utf8mb4_0900_ai_ci |\
| auto_fine_on_return     | INSERT | ReturnRecords | BEGIN\
    DECLARE fine DECIMAL(10,2);\
    SET fine = CalculateFine(NEW.issue_id);\
    SET NEW.fine_amount = fine;\
END                                                                                                                                                             | BEFORE | 2025-11-03 14:11:10.90 | ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION | root@localhost | utf8mb4              | utf8mb4_0900_ai_ci   | utf8mb4_0900_ai_ci |\
| before_student_insert   | INSERT | Students      | BEGIN\
    IF NEW.student_id IS NOT NULL THEN\
        IF (SELECT COUNT(*) FROM Students WHERE student_id = NEW.student_id) > 0 THEN\
            SIGNAL SQLSTATE '45000'\
                SET MESSAGE_TEXT = '
\f1 \uc0\u10060 
\f0  Student ID already exists!';\
        END IF;\
    END IF;\
END         | BEFORE | 2025-11-27 19:29:17.35 | ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION | root@localhost | utf8mb4              | utf8mb4_0900_ai_ci   | utf8mb4_0900_ai_ci |\
| before_student_update   | UPDATE | Students      | BEGIN\
    IF NEW.student_id != OLD.student_id THEN\
        IF (SELECT COUNT(*) FROM Students WHERE student_id = NEW.student_id) > 0 THEN\
            SIGNAL SQLSTATE '45000'\
                SET MESSAGE_TEXT = '
\f1 \uc0\u10060 
\f0  Student ID already exists!';\
        END IF;\
    END IF;\
END   | BEFORE | 2025-11-27 19:29:26.56 | ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION | root@localhost | utf8mb4              | utf8mb4_0900_ai_ci   | utf8mb4_0900_ai_ci |\
+-------------------------+--------+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+------------------------+-----------------------------------------------------------------------------------------------------------------------+----------------+----------------------+----------------------+--------------------+\
4 rows in set (0.00 sec)\
\
mysql> SHOW FUNCTION STATUS WHERE Db = 'LibraryManagement';\
+-------------------+---------------+----------+----------------+---------------------+---------------------+---------------+---------+----------------------+----------------------+--------------------+\
| Db                | Name          | Type     | Definer        | Modified            | Created             | Security_type | Comment | character_set_client | collation_connection | Database Collation |\
+-------------------+---------------+----------+----------------+---------------------+---------------------+---------------+---------+----------------------+----------------------+--------------------+\
| LibraryManagement | CalculateFine | FUNCTION | root@localhost | 2025-11-03 14:10:30 | 2025-11-03 14:10:30 | DEFINER       |         | utf8mb4              | utf8mb4_0900_ai_ci   | utf8mb4_0900_ai_ci |\
+-------------------+---------------+----------+----------------+---------------------+---------------------+---------------+---------+----------------------+----------------------+--------------------+\
1 row in set (0.02 sec)\
\
\
mysql> DELIMITER $$\
mysql> \
mysql> CREATE FUNCTION CalculateFine(issueID INT)\
    -> RETURNS DECIMAL(10,2)\
    -> DETERMINISTIC\
    -> BEGIN\
    ->     DECLARE fine DECIMAL(10,2);\
    ->     DECLARE due DATE;\
    ->     DECLARE diff INT;\
    -> \
    ->     SELECT due_date INTO due \
    ->     FROM IssuedBooks \
    ->     WHERE issue_id = issueID;\
    -> \
    ->     IF CURDATE() > due THEN\
    ->         SET diff = DATEDIFF(CURDATE(), due);\
    ->         SET fine = diff * 10;   \
    ->     ELSE\
    ->         SET fine = 0;\
    ->     END IF;\
    -> \
    ->     RETURN fine;\
    -> END$$\
Query OK, 0 rows affected (0.01 sec)\
\
mysql> \
mysql> DELIMITER ;\
mysql> \
}